<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Onedrive | My New Hugo Site</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.74.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/easyhugo/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    
      <link rel="stylesheet" href="/easyhugo/css/custom.css">
    

    
      

    

    
    
    <meta property="og:title" content="Onedrive" />
<meta property="og:description" content="How to do obtain a hash from onedrive Motivation If you upload a large file like a 4GB file to OneDrive, you might wondering whether it uploaded correctly. I am kind of paranoid about such things, since I want to delete the 4GB in my local drive to free up some space, but at the same time I rather not lose any of my data.
Verification Onedrive provides three types of hashes for a file." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.frankliu.org/easyhugo/posts/onedrive/" />
<meta property="article:published_time" content="2020-09-13T20:56:46-07:00" />
<meta property="article:modified_time" content="2020-09-13T20:56:46-07:00" />
<meta itemprop="name" content="Onedrive">
<meta itemprop="description" content="How to do obtain a hash from onedrive Motivation If you upload a large file like a 4GB file to OneDrive, you might wondering whether it uploaded correctly. I am kind of paranoid about such things, since I want to delete the 4GB in my local drive to free up some space, but at the same time I rather not lose any of my data.
Verification Onedrive provides three types of hashes for a file.">
<meta itemprop="datePublished" content="2020-09-13T20:56:46-07:00" />
<meta itemprop="dateModified" content="2020-09-13T20:56:46-07:00" />
<meta itemprop="wordCount" content="708">



<meta itemprop="keywords" content="," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Onedrive"/>
<meta name="twitter:description" content="How to do obtain a hash from onedrive Motivation If you upload a large file like a 4GB file to OneDrive, you might wondering whether it uploaded correctly. I am kind of paranoid about such things, since I want to delete the 4GB in my local drive to free up some space, but at the same time I rather not lose any of my data.
Verification Onedrive provides three types of hashes for a file."/>

	
    <script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/easyhugo/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        My New Hugo Site
      
    </a>
    <div class="flex-l items-center">
      

      
      















    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://www.frankliu.org/easyhugo/posts/onedrive/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://www.frankliu.org/easyhugo/posts/onedrive/&amp;text=Onedrive" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.frankliu.org/easyhugo/posts/onedrive/&amp;title=Onedrive" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Onedrive</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-09-13T20:56:46-07:00">September 13, 2020</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><h1 id="how-to-do-obtain-a-hash-from-onedrive">How to do obtain a hash from onedrive</h1>
<h2 id="motivation">Motivation</h2>
<p>If you upload a large file like a 4GB file to OneDrive, you might wondering
whether it uploaded correctly.  I am kind of paranoid about such things, since
I want to delete the 4GB in my local drive to free up some space, but at the
same time I rather not lose any of my data.</p>
<h2 id="verification">Verification</h2>
<p>Onedrive provides three types of hashes for a file.  I could only get one of
them to display anything, so I will describe how this can be done.</p>
<ul>
<li>
<p>sha1Hash	String	(Hex string). SHA1 hash for the contents of the file (if
available). Read-only.</p>
</li>
<li>
<p>crc32Hash	String	(Hex string). The CRC32 value of the file in little endian
(if available). Read-only.</p>
</li>
<li>
<p>quickXorHash	String	(Base64 string). A proprietary hash of the file that
can be used to determine if the contents of the file have changed (if
available). Read-only.</p>
</li>
</ul>
<p><a href="https://docs.microsoft.com/en-us/onedrive/developer/rest-api/resources/hashes?view=odsp-graph-online">Hashes</a></p>
<h1 id="sdk-to-the-rescue">SDK to the rescue</h1>
<p>Fortunately there is a onedrive-sdk in python which is a bit old but since
the API hasn&rsquo;t change much, it mostly works.</p>
<h1 id="overview-of-the-steps">Overview of the steps</h1>
<p>For any script to work you have to register the application with microsoft,
which gives you a client_id.  After registering, you can go to the secret
section obtain a secret key as well, this will serve as your client_secret.
Then one more thing you need to setup if the redirect URI, it doesn&rsquo;t have to
be a real site, but it is necessary to match the one that the application uses.</p>
<h2 id="registration">Registration</h2>
<p>You first have to have an account with microsoft, so that you can enter
portal.azure.com.  From there you can either search app registrations,
or it should be on the first services that is shown.</p>
<p>In App registrations, you want to create a new registration, and you should add
the redirect URI at this point (it can be added later, but it is a little bit
more painful because it is not very clear where to do this).  Note that it only
really works for Personal Microsoft accounts only, the other organizational
directories are pertinent only in a multiple user scenario.</p>
<p>The name of the app doesn&rsquo;t really matter, but the redirect URI must match
the one that you use for authentication.</p>
<p>Copy the client id and save it into a json file, I prefer doing it that way
rather than directly coding in to my app.</p>
<h2 id="secret">Secret</h2>
<p>Then choose the secret menus, and generate a secret as well.</p>
<h2 id="json-file">json file</h2>
<p>client.json would look something</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
 <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;the client id&#34;</span>,
 <span style="color:#f92672">&#34;secret&#34;</span>: <span style="color:#e6db74">&#34;the client secret&#34;</span>,
 <span style="color:#f92672">&#34;code&#34;</span>: <span style="color:#e6db74">&#34;the code&#34;</span>
}
</code></pre></div><h1 id="using-the-sdk">Using the sdk</h1>
<h2 id="install">Install</h2>
<p>I think the best is to clone the github repository and</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python setup.py install
</code></pre></div><p>There are <code>pip</code> instructions as well, but for my distribution
python 3.8, it didn&rsquo;t have a version that is current with my
python.</p>
<h2 id="getting-the-authentication-code">Getting the authentication code</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> onedrivesdk
<span style="color:#f92672">import</span> json

json_file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;client.json&#39;</span>
redirect_uri <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://localhost:8080/&#39;</span>
<span style="color:#66d9ef">with</span> open(json_file) <span style="color:#66d9ef">as</span> f:
    jobj <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(f)

client_secret <span style="color:#f92672">=</span> jobj[<span style="color:#e6db74">&#39;secret&#39;</span>] 
client_id<span style="color:#f92672">=</span>jobj[<span style="color:#e6db74">&#39;id&#39;</span>]
api_base_url<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;https://api.onedrive.com/v1.0/&#39;</span>
scopes<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;wl.signin&#39;</span>, <span style="color:#e6db74">&#39;wl.offline_access&#39;</span>, <span style="color:#e6db74">&#39;onedrive.readwrite&#39;</span>]

http_provider <span style="color:#f92672">=</span> onedrivesdk<span style="color:#f92672">.</span>HttpProvider()
auth_provider <span style="color:#f92672">=</span> onedrivesdk<span style="color:#f92672">.</span>AuthProvider(
    http_provider<span style="color:#f92672">=</span>http_provider,
    client_id<span style="color:#f92672">=</span>client_id,
    scopes<span style="color:#f92672">=</span>scopes)

client <span style="color:#f92672">=</span> onedrivesdk<span style="color:#f92672">.</span>OneDriveClient(api_base_url, auth_provider, http_provider)
auth_url <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>auth_provider<span style="color:#f92672">.</span>get_auth_url(redirect_uri)
<span style="color:#75715e"># Ask for the code</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Paste this URL into your browser, approve the app</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">s access.&#39;</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Copy everything in the address bar after &#34;code=&#34;, and paste it below.&#39;</span>)
<span style="color:#66d9ef">print</span>(auth_url)
code <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;Paste code here: &#39;</span>)

client<span style="color:#f92672">.</span>auth_provider<span style="color:#f92672">.</span>authenticate(code, redirect_uri, client_secret)
</code></pre></div><p>There is another script that supposed opens a web server from python didn&rsquo;t
quite work out of the box.  There is another script that removes the manual
step above.   But I didn&rsquo;t work out why the webserver was not working.</p>
<h2 id="code-validity">code validity</h2>
<p>The code lasts for a little while, so I typically add to the client.json we
created above.</p>
<h2 id="command-line-example">Command-line example</h2>
<p>There is a command-line example in the cloned repository under example.
I commented out the part that asks for the code, since that didn&rsquo;t work
for me.</p>
<h1 id="links">links</h1>
<h2 id="portal">portal</h2>
<p>All services - Microsoft Azure
<a href="https://portal.azure.com/#allservices">https://portal.azure.com/#allservices</a></p>
<h2 id="registering-via-powershell">registering via PowerShell</h2>
<p>PowerShell Basics: How to Create an Azure AD App Registration
<a href="https://techcommunity.microsoft.com/t5/itops-talk-blog/powershell-basics-how-to-create-an-azure-ad-app-registration/ba-p/811570">https://techcommunity.microsoft.com/t5/itops-talk-blog/powershell-basics-how-to-create-an-azure-ad-app-registration/ba-p/811570</a></p>
<h2 id="registering-from-portal">registering from portal</h2>
<p>Register an application - Microsoft Azure
<a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade</a></p>
<h2 id="oauth">Oauth</h2>
<p>OAuth 2.0 client credentials flow on the Microsoft identity platform | Microsoft Docs
<a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow">https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow</a></p>
<h2 id="key-vault">Key vault</h2>
<p>What is Azure Key Vault? | Microsoft Docs
<a href="https://docs.microsoft.com/en-us/azure/key-vault/general/basic-concepts?WT.mc_id=ITOPSTALK-blog-abartolo">https://docs.microsoft.com/en-us/azure/key-vault/general/basic-concepts?WT.mc_id=ITOPSTALK-blog-abartolo</a></p>
<p>Key vaults - Microsoft Azure
<a href="https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults">https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults</a></p>
<ul class="pa0">
  
   <li class="list">
     <a href="/easyhugo/tags/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif"></a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/easyhugo/posts/ascii/">Ascii</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/perl/">Perl</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/cpp/">Cpp</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/static/">Static</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/nsf/">Nsf</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/asciidoctor/">Asciidoctor</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/css/">Css</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/family/">Family</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/vnc/">Vnc</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/math/">Math</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/algorithms/">Algorithms</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/machine-learning/">Machine Learning</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/design-patterns/">Design Patterns</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/windows/">Windows</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/easyhugo/posts/vlc/">Vlc</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://www.frankliu.org/easyhugo/" >
    &copy;  My New Hugo Site 2020 
  </a>
    <div>














</div>
  </div>
</footer>

    

  <script src="/easyhugo/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
